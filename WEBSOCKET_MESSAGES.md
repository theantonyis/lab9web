# Повідомлення WebSocket

Цей документ надає приклади повідомлень WebSocket, які використовуються в додатку для чату в реальному часі. Всі повідомлення надсилаються як рядки JSON.

## Типи повідомлень

Додаток використовує кілька типів повідомлень для різних цілей:

1. **Повідомлення аутентифікації**: Використовуються для аутентифікації користувачів
2. **Повідомлення управління кімнатами**: Використовуються для приєднання до чат-кімнат
3. **Повідомлення чату**: Використовуються для надсилання текстових повідомлень
4. **Повідомлення файлів**: Використовуються для обміну файлами
5. **Інформаційні повідомлення**: Використовуються для надання системної інформації

## Повідомлення від клієнта до сервера

### Повідомлення аутентифікації

Надсилається клієнтом для аутентифікації на сервері.

```json
{
  "type": "auth",
  "token": "eyJuYW1lIjoiSm9obiBEb2UifQ=="
}
```

- `type`: Завжди "auth" для повідомлень аутентифікації
- `token`: JSON, закодований в base64, що містить ім'я користувача (наприклад, `{"name":"John Doe"}`)

### Повідомлення приєднання до кімнати

Надсилається клієнтом для приєднання до певної чат-кімнати.

```json
{
  "type": "join",
  "room": "general"
}
```

- `type`: Завжди "join" для повідомлень приєднання до кімнати
- `room`: Назва кімнати для приєднання

### Повідомлення чату

Надсилається клієнтом для надсилання текстового повідомлення до поточної кімнати.

```json
{
  "type": "chat",
  "text": "Hello, everyone!"
}
```

- `type`: Завжди "chat" для текстових повідомлень
- `text`: Вміст повідомлення

### Повідомлення файлу

Надсилається клієнтом для обміну файлом з поточною кімнатою.

```json
{
  "type": "file",
  "name": "document.pdf",
  "data": "data:application/pdf;base64,JVBERi0xLjMKJcTl8uXrp/Og0P..."
}
```

- `type`: Завжди "file" для повідомлень обміну файлами
- `name`: Назва файлу
- `data`: Вміст файлу як URL-адреса даних (закодована в base64)

## Повідомлення від сервера до клієнта

### Інформаційне повідомлення

Надсилається сервером для надання інформації клієнту.

```json
{
  "type": "info",
  "text": "Приєднано до кімнати general"
}
```

- `type`: Завжди "info" для інформаційних повідомлень
- `text`: Інформаційний текст

### Повідомлення чату (Трансляція)

Надсилається сервером для трансляції повідомлення чату всім клієнтам у кімнаті.

```json
{
  "type": "chat",
  "from": "John Doe",
  "text": "Hello, everyone!"
}
```

- `type`: Завжди "chat" для текстових повідомлень
- `from`: Ім'я користувача, який надіслав повідомлення
- `text`: Вміст повідомлення

### Повідомлення файлу (Трансляція)

Надсилається сервером для трансляції файлу всім клієнтам у кімнаті.

```json
{
  "type": "file",
  "from": "John Doe",
  "name": "document.pdf",
  "data": "data:application/pdf;base64,JVBERi0xLjMKJcTl8uXrp/Og0P..."
}
```

- `type`: Завжди "file" для повідомлень обміну файлами
- `from`: Ім'я користувача, який надіслав файл
- `name`: Назва файлу
- `data`: Вміст файлу як URL-адреса даних (закодована в base64)

## Обробка помилок

### Помилка аутентифікації

Надсилається сервером, коли аутентифікація не вдається.

```json
{
  "type": "info",
  "text": "Помилка автентифікації: невірний формат даних"
}
```

## Приклади потоку повідомлень

### Повний потік аутентифікації

1. Клієнт підключається до WebSocket сервера
2. Клієнт надсилає повідомлення аутентифікації:
   ```json
   {
     "type": "auth",
     "token": "eyJuYW1lIjoiSm9obiBEb2UifQ=="
   }
   ```
3. Сервер відповідає вітальним повідомленням:
   ```json
   {
     "type": "info",
     "text": "Вітаємо, John Doe"
   }
   ```

### Повний потік чату

1. Клієнт приєднується до кімнати:
   ```json
   {
     "type": "join",
     "room": "general"
   }
   ```
2. Сервер підтверджує приєднання до кімнати:
   ```json
   {
     "type": "info",
     "text": "Приєднано до кімнати general"
   }
   ```
3. Клієнт надсилає повідомлення:
   ```json
   {
     "type": "chat",
     "text": "Hello, everyone!"
   }
   ```
4. Сервер транслює повідомлення всім клієнтам у кімнаті:
   ```json
   {
     "type": "chat",
     "from": "John Doe",
     "text": "Hello, everyone!"
   }
   ```
